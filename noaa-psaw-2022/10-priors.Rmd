---
title: "Priors and parameter bounds"
subtitle: "NOAA PSAW Seminar Series"
author: ""
institute: ""
date: "March 9, 2022"
output:
  xaringan::moon_reader:
    css: ["xaringan-themer.css", "theme.css"]
    lib_dir: libs
    nature:
      highlightLines: true
      countIncrementalSlides: false
---

<!-- Build with: xaringan::inf_mr() -->

```{r preamble, include=FALSE, cache=FALSE}
source(here::here("noaa-psaw-2022/preamble.R"))
do.call(knitr::opts_chunk$set, knitr_opts)
```

```{r libs, include=FALSE}
library(dplyr)
library(sdmTMB)
library(ggplot2)
```

# Maximum likelihood doesn't involve priors!? 

* Penalized maximum likelihood estimation

* Maximize 

$$L(\theta | y) * P(\theta | \alpha)$$
* $\theta$ are parameters
* $\alpha$ are hyperparameters controlling prior distribution  

---

# Penalized estimation in sdmTMB


```{r echo = TRUE, eval=FALSE}
fit <- sdmTMB(...,
              priors, #<<
              ...)
```

* `?sdmTMBpriors` 

---

# What can we put priors on?

$\beta$ fixed effects
$\phi$ Observation variance parameter
$\rho$ AR(1) parameter
$p$ Tweedie parameter
$\kappa$ Matern range 
$\sigma$ Matern variance

---

# Example: regression coefficients

* Univariate

---

# Example: regression coefficients

* Show example of MVN

---

# Example: Matern

* PC prior example

---

# Bounds

`?sdmTMBcontrol`

```{r eval=FALSE, echo=TRUE}
sdmTMBcontrol(...
              lower,#<<
              upper,#<<
              ...
)
```

